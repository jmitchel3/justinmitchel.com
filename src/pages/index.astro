---
import BaseLayout from '@/layouts/BaseLayout.astro';
import NewsletterForm from '@/components/NewsletterForm.astro';
import { getCollection } from 'astro:content';
import PostCard from '@/components/PostCard.astro';

// Fetch latest posts
const latestPosts = (await getCollection('posts', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 4);

---

<BaseLayout title="Justin Mitchel | Helping you vibe code your projects with AI Agents.">
  <div class="page-container">
    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-bg"></div>
       <h1 class="hero-headline">Let me help you use AI Agents</h1>

      <div class="hero-cta" id="subscribe">
        <NewsletterForm
          variant="hero"
          heading="Weekly tips in your inbox. For Free."
          subheading=""
          showHeading={true}
        />
      </div>
    </section>

    
    <!-- Latest Articles -->
    <section class="latest-articles">
      <div class="section-header">
        <h2 class="section-title">Latest Articles</h2>
        <a href="/articles" class="view-all-link">View all</a>
      </div>
      <div class="posts-grid">
        {latestPosts.map((post) => (
          <PostCard
            title={post.data.title}
            slug={post.slug}
            date={post.data.date}
            description={post.data.description}
            tags={post.data.tags}
            readingTime={post.data.readingTime}
          />
        ))}
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .page-container {
    max-width: 42rem;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  /* Hero */
  .hero {
    padding: 6rem 0 5rem;
    text-align: center;
    position: relative;
  }
  
  .hero-bg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100vw;
    height: 100%;
    max-width: 1200px;
    background-image: radial-gradient(var(--color-text-secondary) 1px, transparent 1px);
    background-size: 24px 24px;
    mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
    z-index: -1;
    opacity: 0.15;
    pointer-events: none;
  }

  .hero-headline {
    font-size: clamp(3rem, 10vw, 4.5rem);
    line-height: 1;
    margin: 0 0 1.5rem 0;
    letter-spacing: -0.04em;
    font-weight: 700;
  }

  .hero-subheadline {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    max-width: 520px;
    margin: 0 auto 2.5rem;
    line-height: 1.5;
  }

  .hero-cta {
    max-width: 420px;
    margin: 0 auto;
  }

  /* Latest Articles */
  .latest-articles {
    padding: 0 0 5rem;
    border-top: 1px solid var(--color-border);
  }
  
  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 2rem;
    padding-top: 3rem;
  }
  
  .section-title {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.02em;
  }
  
  .view-all-link {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    text-decoration: none;
    transition: color 0.2s;
  }
  
  .view-all-link:hover {
    color: var(--color-accent);
  }
  
  .posts-grid {
    display: flex;
    flex-direction: column;
  }

  @media (max-width: 640px) {
    .hero {
      padding: 4rem 0 3rem;
    }
  }
</style>
